{
  "hash": "d16108f8d54f78a0aa368dc1f5e14847",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Valentine's Day Spending\"\nauthor: \"Hardik Monga\"\n---\n\n\n\n# Libraries Used\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(tidyr)\n\nlibrary(mosaic)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRegistered S3 method overwritten by 'mosaic':\n  method                           from   \n  fortify.SpatialPolygonsDataFrame ggplot2\n\nThe 'mosaic' package masks several functions from core packages in order to add \nadditional features.  The original behavior of these functions should not be affected by this.\n\nAttaching package: 'mosaic'\n\nThe following object is masked from 'package:Matrix':\n\n    mean\n\nThe following objects are masked from 'package:dplyr':\n\n    count, do, tally\n\nThe following object is masked from 'package:purrr':\n\n    cross\n\nThe following object is masked from 'package:ggplot2':\n\n    stat\n\nThe following objects are masked from 'package:stats':\n\n    binom.test, cor, cor.test, cov, fivenum, IQR, median, prop.test,\n    quantile, sd, t.test, var\n\nThe following objects are masked from 'package:base':\n\n    max, mean, min, prod, range, sample, sum\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(skimr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'skimr'\n\nThe following object is masked from 'package:mosaic':\n\n    n_missing\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggformula)\nlibrary(ggprism)\nlibrary(ggplot2)\n```\n:::\n\n\n\n# gifts_age Dataset - Import, Glimpse\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngifts_age <- readr::read_csv(\"https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2024/2024-02-13/gifts_age.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 6 Columns: 9\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): Age\ndbl (8): SpendingCelebrating, Candy, Flowers, Jewelry, GreetingCards, Evenin...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\ngifts_age\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 9\n  Age   SpendingCelebrating Candy Flowers Jewelry GreetingCards EveningOut\n  <chr>               <dbl> <dbl>   <dbl>   <dbl>         <dbl>      <dbl>\n1 18-24                  51    70      50      33            33         41\n2 25-34                  40    62      44      34            33         37\n3 35-44                  31    58      41      29            42         30\n4 45-54                  19    60      37      20            42         31\n5 55-64                  18    50      32      13            43         29\n6 65+                    13    42      25       8            44         24\n# ℹ 2 more variables: Clothing <dbl>, GiftCards <dbl>\n```\n\n\n:::\n\n```{.r .cell-code}\nskim(gifts_age)\n```\n\n::: {.cell-output-display}\n\nTable: Data summary\n\n|                         |          |\n|:------------------------|:---------|\n|Name                     |gifts_age |\n|Number of rows           |6         |\n|Number of columns        |9         |\n|_______________________  |          |\n|Column type frequency:   |          |\n|character                |1         |\n|numeric                  |8         |\n|________________________ |          |\n|Group variables          |None      |\n\n\n**Variable type: character**\n\n|skim_variable | n_missing| complete_rate| min| max| empty| n_unique| whitespace|\n|:-------------|---------:|-------------:|---:|---:|-----:|--------:|----------:|\n|Age           |         0|             1|   3|   5|     0|        6|          0|\n\n\n**Variable type: numeric**\n\n|skim_variable       | n_missing| complete_rate|  mean|    sd| p0|   p25|  p50|   p75| p100|hist  |\n|:-------------------|---------:|-------------:|-----:|-----:|--:|-----:|----:|-----:|----:|:-----|\n|SpendingCelebrating |         0|             1| 28.67| 14.73| 13| 18.25| 25.0| 37.75|   51|▇▁▂▂▂ |\n|Candy               |         0|             1| 57.00|  9.78| 42| 52.00| 59.0| 61.50|   70|▃▃▃▇▃ |\n|Flowers             |         0|             1| 38.17|  8.89| 25| 33.25| 39.0| 43.25|   50|▃▃▃▇▃ |\n|Jewelry             |         0|             1| 22.83| 10.87|  8| 14.75| 24.5| 32.00|   34|▅▁▂▁▇ |\n|GreetingCards       |         0|             1| 39.50|  5.09| 33| 35.25| 42.0| 42.75|   44|▃▁▁▁▇ |\n|EveningOut          |         0|             1| 32.00|  6.07| 24| 29.25| 30.5| 35.50|   41|▃▇▃▃▃ |\n|Clothing            |         0|             1| 22.83|  7.36| 12| 19.25| 23.0| 26.75|   33|▃▇▁▇▃ |\n|GiftCards           |         0|             1| 21.17|  1.72| 19| 20.00| 21.0| 22.75|   23|▃▇▁▃▇ |\n\n\n:::\n\n```{.r .cell-code}\ninspect(gifts_age)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\ncategorical variables:  \n  name     class levels n missing                                  distribution\n1  Age character      6 6       0 18-24 (16.7%), 25-34 (16.7%) ...             \n\nquantitative variables:  \n                 name   class min    Q1 median    Q3 max     mean        sd n\n1 SpendingCelebrating numeric  13 18.25   25.0 37.75  51 28.66667 14.733183 6\n2               Candy numeric  42 52.00   59.0 61.50  70 57.00000  9.777525 6\n3             Flowers numeric  25 33.25   39.0 43.25  50 38.16667  8.886319 6\n4             Jewelry numeric   8 14.75   24.5 32.00  34 22.83333 10.870449 6\n5       GreetingCards numeric  33 35.25   42.0 42.75  44 39.50000  5.089204 6\n6          EveningOut numeric  24 29.25   30.5 35.50  41 32.00000  6.066300 6\n7            Clothing numeric  12 19.25   23.0 26.75  33 22.83333  7.359801 6\n8           GiftCards numeric  19 20.00   21.0 22.75  23 21.16667  1.722401 6\n  missing\n1       0\n2       0\n3       0\n4       0\n5       0\n6       0\n7       0\n8       0\n```\n\n\n:::\n:::\n\n\n\n# Variable Types\n\n**Quantitative Variables:** SpendingCelebrating, Candy, Flowers, Clothing, EveningOut, GiftCards, GreetingCards, Jewelry\n\n**Qualitative Variables:** Age\n\n**Observations:** Interestingly, Mean of the amount spent on Candy is the highest among all the items, ie. 57 while Mean for the amount spent on Clothing os 22.83 which is quite unexpected.\n\n**Target Variable**: SpendingCelebrating, Candy, Flowers, Clothing, EveningOut, GiftCards, GreetingCards, Jewelry (the amount spent per gift for all these items is the target variable)\n\n**Predictor variables**: Age\n\n# Plotting a Point graph of SpendingCelebrating and Age\n\nThe line was not showing in the line graph , thus google suggested me to check if point graph is showing something or not to check the data type of the variables.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngifts_age %>%\n  gf_point(SpendingCelebrating ~ Age) %>%\n  gf_labs(\n    title = \"Spending Celebrating by Age\",\n    x = \"Age\",\n    y = \"Spending Celebrating\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n# Plotting the Line graph \n\nHere, I tried to customly changing the shapes of the points of the different Items but it didn't work for some unknown reason.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngifts_age_long <- gifts_age %>%\n  pivot_longer(cols = -Age, names_to = \"Item\", values_to = \"Spending\")\n#I found that pivot_longer is used when you have multiple columns to plot on the y-axis. Here, names_to and values_to avail the rest of columns' title and numeric data sperately.\n\nggplot(gifts_age_long, aes(x = Age, y = Spending, color = Item, group = Item, shape = Item)) +\n  geom_line() +\n  geom_point(shape = 15, size = 3) + \n  labs(title = \"Valentine's Day Spending over Age\",\n       x = \"Age Group in Years\",\n       y = \"Amounts Spent per Gift\") +\n  theme_minimal()+\n    scale_shape_manual(values = c(16, 17, 15, 3, 8, 1,8,1)) \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n# Thoughts and Inference:\n\n-   **Research Experiment that might have been conducted to obtain that data:** I think the motive behind the collection of this data was to check the amount different age groups spend for different types of gifts on Valentine's Day. This data can turn out to be helpful for both big convenience stores, Flower shops, Jewellary shops and small retailers on Valentine's Day and also in general.\n\n-   **Questions that the Graph seeks to answer:** The graphs seeks to compare the price of different items bought by different age groups on Valentine's Day.\n\n-   **My Experience:** For a long time, I was not able to figure out plotting multiple lines on the same graph until I accidentally came across pivot_longer through extensive googling and chatgpting. I still was not able to use unique shapes for each linegraph.\n\n-   **Inference:** Each line graph seems to be going normal except the 'Candy' and 'GreetingCards' lines which seem to be going almost symmetrical and then converging in the end. I get the decline in candy consumption for older people but why is there a sudden increase in spending on greeting cards from 35 onwards?\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}